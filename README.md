# koa-restful

> è¯¾ç¨‹é“¾æ¥
> https://coding.imooc.com/class/354.html

## ç¬¬1ç«  å­¦ä¹ ä¹‹å‰è¦å‘Šè¯‰ä½ çš„

> è¿™ä¸€ç« åªæœ‰ä¸€èŠ‚ï¼Œä¹Ÿåªæœ‰ä¸€ä¸ªç›®çš„ï¼Œå°±æ˜¯å‘Šè¯‰ä½ è¿™é—¨è¯¾ç¨‹è®²äº†ä»€ä¹ˆï¼Œæœ€ç»ˆåšå‡ºçš„æ•ˆæœï¼Œä»¥åŠå­¦ä¹ è¿™é—¨è¯¾ç¨‹ä½ éœ€è¦å…ˆæŒæ¡å“ªäº›æŠ€æœ¯ã€‚

### 1-1 å…³äºè¿™é—¨è¯¾ç¨‹ä½ æƒ³çŸ¥é“çš„éƒ½åœ¨è¿™ä¸€èŠ‚é‡Œé¢äº†

- è¯¾ç¨‹ç›®æ ‡
  - ç†è§£RESTful APIçš„6ä¸ªé™åˆ¶å’Œè‹¥å¹²æœ€ä½³å®è·µ
  - æŒæ¡Koa2ã€Postmanã€ MongoDBã€JWTç­‰æŠ€æœ¯
  - è¿ç”¨ä¸Šè¿°æŠ€æœ¯æ­å»ºä»¿çŸ¥ä¹RESTful API
  - æŒæ¡é˜¿é‡Œäº‘çº¿ä¸Šéƒ¨ç½²æ–¹æ³•
- åŠŸèƒ½æŠ€æœ¯åˆ†æ
  - RESTful APIç†è®º
  - Koa2
  - Postman
  - MongoDB
  - JWT
  - é˜¿é‡Œäº‘éƒ¨ç½²
- å‰ç½®çŸ¥è¯†
  - Node.js åŸºç¡€
  - ES6ã€ES7 åŸºç¡€
- é‡éš¾ç‚¹åˆ†æ
  - RESTful APIç†è®º
  - JWTè®¤è¯åŸç†
  - å¤æ‚çš„æ•°æ®åº“å…³ç³»ï¼ˆä¸€å¯¹å¤šã€å¤šå¯¹å¤šç­‰ï¼‰
- è¯¾ç¨‹å»ºè®®
  - ç†è®ºéƒ¨åˆ†åšåˆ°è‡ªé—®è‡ªç­”
  - å®æˆ˜éƒ¨åˆ†åšåˆ°ä¸¾ä¸€åä¸‰
  - ä¸æ­¢äºæœ¬è¯¾ç¨‹ï¼Œå­¦ä¹ æ›´å¤šæŠ€æœ¯

## ç¬¬2ç«  è·Ÿç€ GitHub è®¤è¯† RESTful API

> æœ¬ç« ä»¥å…¨çƒæœ€å¤§çš„åŒæ€§ç¤¾äº¤ç¤¾åŒº GitHub çš„ RESTful API åå‡ ä¸ªæœ€ä½³å®è·µä¸ºä¾‹ï¼Œè®©ä½ æŒæ¡æœ€å®Œæ•´çš„ RESTful API ç†è®º

### 2-1 REST æ˜¯ä»€ä¹ˆä»¥åŠå®ƒçš„ 6 ä¸ªé™åˆ¶

#### RESTæ˜¯ä»€ä¹ˆï¼šä¸‡ç»´ç½‘è½¯ä»¶ç»“æ„é£æ ¼

RESTï¼š**Re**presentational **S**tate **T**ransfer

- Representational: æ•°æ®çš„è¡¨ç°å½¢å¼(JSONã€XM.....)
- State: å½“å‰çŠ¶æ€æˆ–è€…æ•°æ®
- Transfer: æ•°æ®ä¼ è¾“

#### RESTfulçš„6ä¸ªé™åˆ¶

1. å®¢æˆ·ä¸€æœåŠ¡å™¨( Clientä¸€Server )
   - å…³æ³¨ç‚¹åˆ†ç¦»
   - æœåŠ¡ç«¯ä¸“æ³¨æ•°æ®å­˜å‚¨,æå‡äº†ç®€å•æ€§
   - å‰ç«¯ä¸“æ³¨ç”¨æˆ·ç•Œé¢,æå‡äº†å¯ç§»æ¤æ€§
1. æ— çŠ¶æ€( Stateless )
   - æ‰€æœ‰ç”¨æˆ·ä¼šè¯ä¿¡æ¯éƒ½ä¿å­˜åœ¨å®¢æˆ·ç«¯
   - æ¯æ¬¡è¯·æ±‚å¿…é¡»åŒ…æ‹¬æ‰€æœ‰ä¿¡æ¯,ä¸èƒ½ä¾èµ–ä¸Šä¸‹æ–‡ä¿¡æ¯
   - æœåŠ¡ç«¯ä¸ç”¨ä¿å­˜ä¼šè¯ä¿¡æ¯,æå‡äº†ç®€å•æ€§ã€å¯é æ€§ã€å¯è§æ€§
1. ç¼“å­˜( Cache )
   - æ‰€æœ‰æœåŠ¡ç«¯å“åº”éƒ½è¦è¢«æ ‡ä¸ºå¯ç¼“å­˜æˆ–ä¸å¯ç¼“å­˜
   - å‡å°‘å‰åç«¯äº¤äº’,æå‡äº†æ€§èƒ½
1. ç»Ÿä¸€æ¥å£( Uniform Interface )
   - æ¥å£è®¾è®¡å°½å¯èƒ½ç»Ÿä¸€é€šç”¨,æå‡äº†ç®€å•æ€§ã€å¯è§æ€§
   - æ¥å£ä¸å®ç°è§£è€¦,ä½¿å‰åç«¯å¯ä»¥ç‹¬ç«‹å¼€å‘è¿­ä»£
1. åˆ†å±‚ç³»ç»Ÿ( Layered System )
   - æ¯å±‚åªçŸ¥é“ç›¸é‚»çš„ä¸€å±‚,åé¢éšè—çš„å°±ä¸çŸ¥é“äº†
   - å®¢æˆ·ç«¯ä¸çŸ¥é“æ˜¯å’Œä»£ç†è¿˜æ˜¯çœŸå®æœåŠ¡å™¨é€šä¿¡
   - å…¶ä»–å±‚:å®‰å…¨å±‚ã€è´Ÿè½½å‡è¡¡ã€ç¼“å­˜å±‚ç­‰
1. æŒ‰éœ€ä»£ç ( Codeä¸€Onä¸€Demandå¯é€‰ )
   - å®¢æˆ·ç«¯å¯ä»¥ä¸‹è½½è¿è¡ŒæœåŠ¡ç«¯ä¼ æ¥çš„ä»£ç (æ¯”å¦‚JS)
   - é€šè¿‡å‡å°‘ä¸€äº›åŠŸèƒ½,ç®€åŒ–äº†å®¢æˆ·ç«¯
 
### 2-2 ç»Ÿä¸€æ¥å£çš„é™åˆ¶

- èµ„æºçš„æ ‡è¯†
  - èµ„æºæ˜¯ä»»ä½•å¯ä»¥å‘½åçš„äº‹ç‰©,æ¯”å¦‚ç”¨æˆ·ã€è¯„è®ºç­‰
  - æ¯ä¸ªèµ„æºå¯ä»¥é€šè¿‡URIè¢«å”¯ä¸€åœ°æ ‡è¯†
    - https://api.github.com/users
    - https://api.github.com/users/lewis617
- é€šè¿‡è¡¨è¿°æ¥æ“ä½œèµ„æº
  - è¡¨è¿°å°±æ˜¯Representationï¼Œæ¯”å¦‚JSONã€XMLç­‰
  - å®¢æˆ·ç«¯ä¸èƒ½ç›´æ¥æ“ä½œ(æ¯”å¦‚SQL)æœåŠ¡ç«¯èµ„æº
  - å®¢æˆ·ç«¯åº”è¯¥é€šè¿‡è¡¨è¿°(æ¯”å¦‚JSON)æ¥æ“ä½œèµ„æº
- è‡ªæè¿°æ¶ˆæ¯
  - æ¯ä¸ªæ¶ˆæ¯ï¼ˆè¯·æ±‚æˆ–å“åº”ï¼‰å¿…é¡»æä¾›è¶³å¤Ÿçš„ä¿¡æ¯è®©æ¥å—è€…ç†è§£
  - åª’ä½“ç±»å‹ï¼ˆapplication/jsonã€application/xmlï¼‰
  - HTTPæ–¹æ³•ï¼šGETï¼ˆæŸ¥ï¼‰ã€POSTï¼ˆå¢ï¼‰ã€DELETEï¼ˆåˆ ï¼‰
  - æ˜¯å¦ç¼“å­˜ï¼š Cache-Control
- è¶…åª’ä½“ä½œä¸ºåº”ç”¨çŠ¶æ€å¼•æ“
  - è¶…åª’ä½“ï¼šå¸¦æ–‡å­—çš„é“¾æ¥
  - åº”ç”¨çŠ¶æ€ï¼šä¸€ä¸ªç½‘é¡µ
  - å¼•æ“ï¼šé©±åŠ¨ã€è·³è½¬
  - åˆèµ·æ¥ï¼šç‚¹å‡»é“¾æ¥è·³è½¬åˆ°å¦ä¸€ä¸ªç½‘é¡µ

### 2-3 RESTful API ç®€ä»‹

#### RESTful APIå…·ä½“ä»€ä¹ˆæ ·å­ï¼Ÿ

- åŸºæœ¬çš„URI ï¼Œå¦‚httpsï¼š//api.github.com/users
- æ ‡å‡†HTTPæ–¹æ³•ï¼Œå¦‚GETï¼Œ POSTï¼Œ PUTï¼Œ PATCHï¼Œ DELETE
- ä¼ è¾“çš„æ•°æ®åª’ä½“ç±»å‹ï¼Œå¦‚JSONï¼Œ XML

#### ç°å®ä¸¾ä¾‹

| Methed |   URI    |   Meaning    |
| :----: | :------: | :----------: |
|  GET   |  /users  | è·å–useråˆ—è¡¨ |
|  GET   | /users/1 |  æŸ¥çœ‹user1   |
|  POST  |  /users  | æ–°å»ºä¸€ä¸ªuser |
|  PUT   | /users/1 | æ›´æ–° user 1  |
| DELETE | /users/1 | åˆ é™¤ user 1  |

### 2-4 RESTful API è®¾è®¡æœ€ä½³å®è·µ

- è¯·æ±‚è®¾è®¡è§„èŒƒ
  - URIä½¿ç”¨åè¯ï¼Œå°½é‡ç”¨å¤æ•°ï¼Œå¦‚/users
  - URIä½¿ç”¨åµŒå¥—è¡¨ç¤ºå…³è”å…³ç³»ï¼Œå¦‚/users/12/repos/5
  - ä½¿ç”¨æ­£ç¡®çš„HTTPæ–¹æ³•ï¼Œå¦‚GET/POST/PUT/DELETE
  - ä¸ç¬¦åˆCRUDçš„æƒ…å†µï¼šPOST/action/å­èµ„æº
- ç›¸åº”è®¾è®¡è§„èŒƒ
  - æŸ¥è¯¢
  - åˆ†é¡µ
  - å­—æ®µè¿‡æ»¤
  - çŠ¶æ€ç 
  - é”™è¯¯å¤„ç†
- å®‰å…¨
  - HTTPS
  - é‰´æƒ
  - é™æµ
- å¼€å‘è€…å‹å¥½
  - æ–‡æ¡£
  - è¶…åª’ä½“

## ç¬¬3ç«  ç”¨ Koa è¯´ Hello World

> æœ¬ç« å°†å¸¦ä½ äº†è§£ä»€ä¹ˆæ˜¯ Koa æ¡†æ¶ï¼Œæ­å»º Koa æ¡†æ¶çš„å¼€å‘ç¯å¢ƒï¼Œå¹¶ä¸”ç¼–å†™ç¬¬ä¸€ä¸ª Koa æ¡†æ¶çš„ç¨‹åºã€‚ä¸ä»…å¦‚æ­¤ï¼Œé‡ç‚¹æ˜¯è¿˜è¦å¸¦ä½ ç†è§£ä»€ä¹ˆæ˜¯ Koa ä¸­é—´ä»¶ä»¥åŠç»å…¸çš„æ´‹è‘±æ¨¡å‹ã€‚

### 3-1 Koa ç®€ä»‹

#### ä¸€å¥è¯ç®€ä»‹

> åŸºäºNode.jsçš„ä¸‹ä¸€ä»£webå¼€å‘**æ¡†æ¶**

- åŸºäºNode.jsï¼š Node.jsæ¨¡å—
- ä¸‹ä¸€ä»£ï¼šèš•é£Ÿç¬¬ä¸€ä»£Webæ¡†æ¶Expressçš„å¸‚åœº
- Webæ¡†æ¶ï¼šä¸æ˜¯å‘½ä»¤è¡Œå·¥å…·ã€ä¸æ˜¯ç®—æ³•

#### å®˜ç½‘ç®€ä»‹

> Koaæ˜¯ä¸€ä¸ªæ–°çš„webæ¡†æ¶ï¼Œç”±Expresså¹•åçš„åŸç­äººé©¬æ‰“é€ ï¼Œè‡´åŠ›äºæˆä¸ºwebåº”ç”¨å’ŒAPIå¼€å‘é¢†åŸŸä¸­çš„ä¸€ä¸ªæ›´å°ã€æ›´å¯Œæœ‰è¡¨ç°åŠ›ã€æ›´å¥å£®çš„åŸºçŸ³ã€‚é€šè¿‡åˆ©ç”¨asyncå‡½æ•°ï¼Œ Koaå¸®ä½ ä¸¢å¼ƒå›è°ƒå‡½æ•°ï¼Œå¹¶æœ‰åŠ›åœ°å¢å¼ºé”™è¯¯å¤„ç†ã€‚Koaå¹¶æ²¡æœ‰æ†ç»‘ä»»ä½•ä¸­é—´ä»¶ï¼Œè€Œæ˜¯æä¾›äº†ä¸€å¥—ä¼˜é›…çš„æ–¹æ³•ï¼Œå¸®åŠ©æ‚¨å¿«é€Ÿè€Œæ„‰å¿«åœ°ç¼–å†™æœåŠ¡ç«¯åº”ç”¨ç¨‹åºã€‚

- ç”±Expresså¹•åçš„åŸç­äººé©¬æ‰“é€ 
- Webåº”ç”¨å’ŒAPIå¼€å‘é¢†åŸŸ
- æ›´å°ã€æ›´å¯Œæœ‰è¡¨ç°åŠ›ã€æ›´å¥å£®
- åˆ©ç”¨asyncå‡½æ•°ï¼Œä¸¢å¼ƒå›è°ƒå‡½æ•°
- å¢å¼ºé”™è¯¯å¤„ç†ï¼štry catch
- æ²¡æœ‰æ†ç»‘ä»»ä½•ä¸­é—´ä»¶
- å¿«é€Ÿè€Œæ„‰å¿«åœ°ç¼–å†™ç¨‹åº

### 3-2 å®‰è£…æ­å»ºç¬¬ä¸€ä¸ª Koa ç¨‹åº

> æ“ä½œæ­¥éª¤
> - åˆå§‹åŒ–é¡¹ç›®
> - å®‰è£…Koa
> - ç¼–å†™Hello World
> - å­¦ä¹ è‡ªåŠ¨é‡å¯

#### åˆå§‹åŒ–é¡¹ç›®

åœ¨åˆé€‚çš„ä½ç½®æ–°å»ºé¡¹ç›®æ–‡ä»¶å¤¹

åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œ`npm init`

#### å®‰è£…Koa

`npm i koa --save`

æ–°å»ºJSæ–‡ä»¶ï¼Œæ¯”å¦‚`index.js`

#### ç¼–å†™Hello World

[ä»£ç ](https://github.com/vincenteliang/koa-restful/commit/81a902b36fec79c38d47099d33400bee46f2f790)

#### è‡ªåŠ¨é‡å¯

`npm i nodemon --save-dev`

ç”±äºæ˜¯æœ¬åœ°å®‰è£…æ‰€ä»¥å¹¶ä¸èƒ½åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹ç›´æ¥æ‰§è¡Œ`nodemon index.js`ï¼Œæˆ‘ä»¬åœ¨`package.json`ä¸­æ·»åŠ å¦‚ä¸‹å‘½ä»¤ï¼š

```json package.json
"scripts": {
    "start": "nodemon index.js"
}
```

### 3-3 Koa ä¸­é—´ä»¶ä¸æ´‹è‘±æ¨¡å‹

> æ“ä½œæ­¥éª¤
> - å­¦ä¹  async await
> - å­¦ä¹ ç¼–å†™Koaä¸­é—´ä»¶
> - å­¦ä¹ æ´‹è‘±æ¨¡å‹

#### async await

è·å–ä¸¤ä¸ªGitHubçš„æ¥å£å¹¶è¿”å›

[ä»£ç ](https://github.com/vincenteliang/koa-restful/commit/7a28c4d7dfcc24334934c0eff59816a28f0c8bea)

#### ç¼–å†™Koaä¸­é—´ä»¶

[ä»£ç ](https://github.com/vincenteliang/koa-restful/commit/7a28c4d7dfcc24334934c0eff59816a28f0c8bea)

#### æ´‹è‘±æ¨¡å‹

ä¸ŠèŠ‚ä»£ç æ‰“å°çš„é¡ºåºä¸ºï¼š1 3 5 4 2ï¼Œç±»ä¼¼ä¸€ä¸ªğŸ§…

## ç¬¬4ç«  Koa æ¡†æ¶çš„è·¯ç”±ä¸ RESTful API æœ€ä½³å®è·µ

> æœ¬ç« ä¸»è¦è®²è§£ Koa æ¡†æ¶çš„è·¯ç”±ã€‚å’Œå…¶ä»–è¯¾ç¨‹çš„åŒºåˆ«åœ¨äºï¼Œä¸ä»…è¦å­¦ä¹  Koa æ¡†æ¶æœ¬èº«çš„è·¯ç”±ç”¨æ³•ï¼Œè¿˜è¦å­¦ä¹ å®ç° REST é£æ ¼çš„è·¯ç”±ç”¨æ³•ã€‚

### 4-1 è·¯ç”±ç®€ä»‹

#### è·¯ç”±æ˜¯ä»€ä¹ˆï¼Ÿ

- å†³å®šäº†ä¸åŒURLæ˜¯å¦‚ä½•è¢«ä¸åŒåœ°æ‰§è¡Œçš„
- åœ¨Koaä¸­ï¼Œæ˜¯ä¸€ä¸ªä¸­é—´ä»¶

#### ä¸ºä»€ä¹ˆè¦ç”¨è·¯ç”±ï¼Ÿ

- å¦‚æœæ²¡æœ‰è·¯ç”±ï¼Œä¼šæ€ä¹ˆæ ·ï¼Ÿ
- è·¯ç”±å­˜åœ¨çš„æ„ä¹‰

#### å¦‚æœæ²¡æœ‰è·¯ç”±

- æ‰€æœ‰è¯·æ±‚éƒ½åšäº†ç›¸åŒçš„äº‹
- æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¿”å›ç›¸åŒçš„ç»“æœ

#### è·¯ç”±å­˜åœ¨çš„æ„ä¹‰

- å¤„ç†ä¸åŒçš„URL
- å¤„ç†ä¸åŒçš„HTTPæ–¹æ³•
- è§£æURLä¸Šçš„å‚æ•°

### 4-2 è‡ªå·±ç¼–å†™ Koa è·¯ç”±ä¸­é—´ä»¶

> æ“ä½œæ­¥éª¤
> - å¤„ç†ä¸åŒçš„URL
> - å¤„ç†ä¸åŒçš„HTTPæ–¹æ³•
> - è§£æURLä¸Šçš„å‚æ•°

[ä»£ç ](https://github.com/vincenteliang/koa-restful/commit/0035b0a790a662b8182647d45e391b3119114a8d)

### 4-3 ä½¿ç”¨ koa-router å®ç°è·¯ç”±

> æ“ä½œæ­¥éª¤
> - æ›´ä¼˜é›…åœ°å®ç°è·¯ç”±åŸºæœ¬åŠŸèƒ½
> - æ¼”ç¤ºä¸€äº›é«˜çº§è·¯ç”±åŠŸèƒ½ï¼Œå¦‚å‰ç¼€ã€å¤šä¸­é—´ä»¶

#### è·¯ç”±åŸºæœ¬åŠŸèƒ½

[ä»£ç ](https://github.com/vincenteliang/koa-restful/commit/318d579ce4639b442a12ff18d7a24d03f4e0087f)

#### é«˜çº§è·¯ç”±åŠŸèƒ½

[ä»£ç ](https://github.com/vincenteliang/koa-restful/commit/5e417fd9b71027a55291f9d7a51c8a26794dc77d)

### 4-4 HTTP options æ–¹æ³•çš„ä½œç”¨æ˜¯ä»€ä¹ˆ

#### ä¸ºä½•è¦äº†è§£optionsæ–¹æ³•çš„ä½œç”¨ï¼Ÿ

- è¿™æ˜¯ä¸€é“é¢è¯•é¢˜
- å¸®åŠ©ç†è§£koa-routerçš„allowedMethodsçš„ä½œç”¨

#### HTTP optionsæ–¹æ³•çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ

- æ£€æµ‹æœåŠ¡å™¨æ‰€æ”¯æŒçš„è¯·æ±‚æ–¹æ³•
- CORSä¸­çš„é¢„æ£€è¯·æ±‚

#### allowedMethodsçš„ä½œç”¨

- å“åº”optionsæ–¹æ³•ï¼Œå‘Šè¯‰å®ƒæ‰€æ”¯æŒçš„è¯·æ±‚æ–¹æ³•
- ç›¸åº”åœ°è¿”å›405ï¼ˆä¸å…è®¸ï¼‰å’Œ501ï¼ˆæ²¡å®ç°ï¼‰

[ä»£ç ](https://github.com/vincenteliang/koa-restful/commit/f0207fd03319e9bd970dbcac739fb6b66667d61d)

### 4-5 RESTful API æœ€ä½³å®è·µâ€”â€”å¢åˆ æ”¹æŸ¥åº”è¯¥è¿”å›ä»€ä¹ˆå“åº”

> æ“ä½œæ­¥éª¤
> - å®ç°å¢åˆ æ”¹æŸ¥
> - è¿”å›æ­£ç¡®çš„å“åº”

[ä»£ç ](https://github.com/vincenteliang/koa-restful/commit/5fdff16e660731945fad42658de902b5bdebb17d)

## ç¬¬5ç«  Koa æ¡†æ¶çš„æ§åˆ¶å™¨ä»¥åŠè®¾è®¡æ›´åˆç†çš„ç›®å½•ç»“æ„

> æœ¬ç« ä¸»è¦è®²è§£ Koa æ¡†æ¶çš„æ§åˆ¶å™¨éƒ¨åˆ†çš„å†…å®¹ã€‚ä»å¦‚ä½•è·å– HTTP çš„è¯·æ±‚å‚æ•°ï¼Œåˆ°å‘é€ HTTP çš„å“åº”ï¼Œä¸€åº”ä¿±å…¨ã€‚è®©ä½ æ˜ç™½ç›®å½•ç»“æ„æ˜¯æ€ä¹ˆæ¥è®¾è®¡çš„æ›´åˆç†ã€‚

### 5-1 æ§åˆ¶å™¨ç®€ä»‹

- ä»€ä¹ˆæ˜¯æ§åˆ¶å™¨ï¼Ÿ
  - æ‹¿åˆ°è·¯ç”±åˆ†é…çš„ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ
  - åœ¨Koaä¸­ï¼Œæ˜¯ä¸€ä¸ªä¸­é—´ä»¶
- ä¸ºä»€ä¹ˆè¦ç”¨æ§åˆ¶å™¨ï¼Ÿ
  - è·å–HTTPè¯·æ±‚å‚æ•°
  - å¤„ç†ä¸šåŠ¡é€»è¾‘
  - å‘é€HTTPå“åº”
- è·å–HTTPè¯·æ±‚å‚æ•°
  - Query String, å¦‚ `?q=keyword`, ä¸€èˆ¬ä¸ºå¯é€‰
  - Router Params, å¦‚ `/users/:id`, ä¸€èˆ¬ä¸ºå¿…é€‰
  - Body, å¦‚ `{ nameï¼š "æé›·" }`
  - Header, å¦‚ `Accept`, `Cookie`
- å‘é€HTTPå“åº”
  - å‘é€Statusï¼Œå¦‚`200`/`400`ç­‰
  - å‘é€Bodyï¼Œå¦‚`{ nameï¼š"æé›·" }`
  - å‘é€Headerï¼Œå¦‚`Allow`ã€`Content-Type`
- ç¼–å†™æ§åˆ¶å™¨æœ€ä½³å®è·µ
  - æ¯ä¸ªèµ„æºçš„æ§åˆ¶å™¨æ”¾åœ¨ä¸åŒçš„æ–‡ä»¶é‡Œ
  - å°½é‡ä½¿ç”¨ ç±»+ç±»æ–¹æ³• çš„å½¢å¼ç¼–å†™æ§åˆ¶å™¨
  - ä¸¥è°¨çš„é”™è¯¯å¤„ç†

### 5-2 è·å– HTTP è¯·æ±‚å‚æ•°

> æ“ä½œæ­¥éª¤
> - å­¦ä¹ æ–­ç‚¹è°ƒè¯•
> - è·å–query (ctx.query)
> - è·å–router params (ctx.params)
> - è·å–body (ctx.request.body)
> - è·å–header (ctx.header)

#### æ–­ç‚¹è°ƒè¯•

VSCodeä¸­æŒ‰F5è¿›å…¥è°ƒè¯•å¹¶è®¾ç½®æ–­ç‚¹

#### è·å–body

koaä¸æ”¯æŒè§£æè¯·æ±‚ä½“ï¼Œéœ€è¦å¼•å…¥ä¸­é—´ä»¶**koa-bodyparser**

`npm i koa-bodyparser --save`

[ä»£ç ](https://github.com/vincenteliang/koa-restful/commit/98e21309f4211dd84adece36baeb2762429bf56e)

### 5-3 å‘é€ HTTP å“åº”

> æ“ä½œæ­¥éª¤
> - å‘é€ status
> - å‘é€ body
> - å‘é€ header
> - å®ç°ç”¨æˆ·çš„å¢åˆ æ”¹æŸ¥

#### å‘é€ status & body

`ctx.status = 204;`

`ctx.body = '<h1>è¿™æ˜¯ä¸»é¡µ</h1>';`

#### å‘é€ header

[ä»£ç ](https://github.com/vincenteliang/koa-restful/commit/fd4c2302270c0094bd30778b4eff611e4b1ca48b)

#### å®ç°ç”¨æˆ·çš„å¢åˆ æ”¹æŸ¥

[ä»£ç ](https://github.com/vincenteliang/koa-restful/commit/fd4c2302270c0094bd30778b4eff611e4b1ca48b)

### 5-4 æ›´åˆç†çš„ç›®å½•ç»“æ„

> æ“ä½œæ­¥éª¤
> - å°†è·¯ç”±å•ç‹¬æ”¾åœ¨ä¸€ä¸ªç›®å½•
> - å°†æ§åˆ¶å™¨å•ç‹¬æ”¾åœ¨ä¸€ä¸ªç›®å½•
> - ä½¿ç”¨ ç±»+ç±»æ–¹æ³• çš„æ–¹å¼ç»„ç»‡æ§åˆ¶å™¨

æ–°å»ºæ€»æ–‡ä»¶å¤¹`/app`ï¼Œå¹¶ä¿®æ”¹å…¥å£æ–‡ä»¶

```json package.json
"scripts": {
    "start": "nodemon app"
}
```

- /app
  - /routes
    - home.js
    - users.js
  - /controllers
    - home.js
    - users.js

[ä»£ç ](https://github.com/vincenteliang/koa-restful/commit/49e15bcd9d9fcd3d45fe93895c33dc6315238cc6)


<!-- [commit]() -->